@{
    ViewBag.Title = "Danh sách hội đồng thi";
    Layout = "~/Views/Shared/_Layout.cshtml";
    var id = ViewBag.Id;
    var TenKhoaThi = ViewBag.TenKhoaThi;
    var lst_PT = (List<Quản_lý_điểm_thi.Models.PT_VALUE_NAME>)ViewBag.lst_PT;
}
@section Styles
{
<style>
    .dataTables_info {
        font-size: 10px;
    }
        a{
        font-size:15px;
    }
</style>
}
@section script
{

    <script src="~/dist/js/jquery.dataTables.js"></script>
    <script src="~/dist/js/dataTables.bootstrap4.js"></script>
    <!-- #region RELOAD -->
    <script>
        function reload()
        {
            location.reload();
            document.getElementById('search').value = "";
        }
    </script>
    <!-- #endregion -->
    <!-- #region Tạo bảng dữ liệu -->
    <script>


    $(document).ready(function () {
           var t = $("#demoGrid").DataTable({
                initComplete: function() {
                    $(this.api().table().container()).find('input').parent().wrap('<form>').parent().attr('autocomplete', 'off');
                },
                "processing": true, // for show progress bar
                "serverSide": true, // for process server side
                "filter": true, // this is for disable filter (search box)
                "orderMulti": false, // for disable multiple column at once
                "pageLength": 5,

                "ajax": {
                    "url": "/HoiDongThi/LoadData/"+@id,
                    "type": "POST",
                    "datatype": "json",

                },
                "columnDefs":
 [     {
     "searchable": false,
     "orderable": false,
     "targets": 0
 },
    {
        "targets":  [5,6,7,8,9],
        "visible": false,
    },
              { "width": "50px", "targets": 0 },
        { "width": "50px", "targets": 1 },
    { "width": "200px", "targets": 10 },
 {
     "targets": [1,7],
     "searchable": false,
     "orderable": false,
 },
 {
     "targets": [10],
     "searchable": false,
     "orderable": false,
     "className" : 'text-center'
    }
 ],

                "columns": [
                      { "data": "Id", "name": "Id", "autoWidth": true },
                                          {
                                              "render": function (data, type, full, meta) {
                                                  return '<a href="/ExamRoom/index/' + full.Id + '" ><img src="/Content/img/icons8-folder-240.png"   style="width:30px;height:30px;margin-left:20px;cursor:pointer"></a>' ;
                                              }
                                          },
                                                             {
                                                                 "render": function (data, type, full, meta) {
                                                                     return '<a href="/ExamRoom/index/' + full.Id + '" >'+full.value_1+'</a>' ;
                                                                 }
                                                             },
                      { "data": "value_2", "name": "value_2", "autoWidth": true },
                      { "data": "value_3", "name": "value_3", "autoWidth": true },
                      { "data": "value_4", "name": "value_4", "autoWidth": true },
                      { "data": "value_5", "name": "value_5", "autoWidth": true },
                      { "data": "value_6", "name": "value_6", "autoWidth": true },
                      { "data": "value_7", "name": "value_7", "autoWidth": true },
                      { "data": "value_8", "name": "value_8", "autoWidth": true },
                       
                      {
                          "render": function (data, type, full, meta)

                          {
                              return '<button type="button" data-toggle="modal" onclick = "EditData(' + full.Id + ')" data-target="#createModal" style="padding:2px 6px;margin-left: 10px;border-radius: 10px !important;" class="btn btn-info"><i class="fa fa-edit"></i></button>' +
                                    '<button type="button"  onclick = "DeleteData(' + full.Id + ')" style="padding:2px 6px;margin-left: 10px;border-radius: 10px !important;" class="btn btn-danger"><i class="fa fa-trash"></i></button>' +
                                     '<button type="button" data-toggle="modal" data-target="#createModal" onclick = "Detail(' + full.Id + ')" style="padding:2px 6px;margin-left: 10px;border-radius: 10px !important;" class="btn btn-success"><i class="fa fa-eye"></i></button>';
                          }
                      },
                ]
           });
        t.on('draw.dt', function () {
            var PageInfo = $('#demoGrid').DataTable().page.info();
            t.column(0, { page: 'current' }).nodes().each(function (cell, i) {
                cell.innerHTML = i + 1 + PageInfo.start;
            });
        });
        });
    </script>
    <script>
        $(document).ready(function () {
            $("input[type='search']").wrap("<form>");
            $("input[type='search']").closest("form").attr("autocomplete", "off");
            document.getElementById("search").placeholder = "Tìm hội đồng thi";
        });
    </script>
    <!-- #endregion -->
    <!-- #region Lưu chỉnh sửa phòng thi -->
    <script>
        function SaveorCreate() {

            if(document.getElementById('txtID').value =="")
            {
                CreateNew();
            }
            else
            {
                Save();
            }
        }
    </script>
    <!-- #endregion -->
    <!-- #region REset form để tạo mới -->
    <script>
        function ResetForm()
        {
            document.getElementById('txtID').value ="";
            document.getElementById('value_1').value = "";
            document.getElementById('value_2').value = "";
            document.getElementById('value_3').value = "";
            document.getElementById('value_4').value = "";
            document.getElementById('value_5').value = "";
            document.getElementById('value_6').value = "";
            document.getElementById('value_7').value = "";
            document.getElementById('value_8').value ="";

        }
    </script>
    <!-- #endregion -->
    <!-- #region Lưu chỉnh sửa phòng thi -->
    <script>
        function Save()
        {
            $.post("@Url.Action("saveJS", "HoiDongThi")",
        {
            id: document.getElementById('txtID').value,
            value_1: document.getElementById('value_1').value,
            value_2: document.getElementById('value_2').value,
            value_3: document.getElementById('value_3').value,
            value_4: document.getElementById('value_4').value,
            value_5: document.getElementById('value_5').value,
            value_6: document.getElementById('value_6').value,
            value_7: document.getElementById('value_7').value,
            value_8: document.getElementById('value_8').value,

            },
        function (data) {
            if (data == -1) {

            }
            else {
                document.getElementById('myModalLabel').value = "Lưu thành công";
                showSuccessMessage("Lưu thông tin thành công");
                $("#demoGrid").DataTable().ajax.reload();
                $('#createModal').modal('hide')
            }
        });
        }
    </script>
    <!-- #endregion -->
    <!-- #region Tạo mới phòng thi -->
    <script>
        function CreateNew()
        {

            $.post("@Url.Action("CreateNewJS", "HoiDongThi")",
        {
            id_exam :@id,
            value_1: document.getElementById('value_1').value,
            value_2: document.getElementById('value_2').value,
            value_3: document.getElementById('value_3').value,
            value_4: document.getElementById('value_4').value,
            value_5: document.getElementById('value_5').value,
            value_6: document.getElementById('value_6').value,
            value_7: document.getElementById('value_7').value,
            value_8: document.getElementById('value_8').value,
           
            },
        function (data) {
            if (data == -1) {

            }
            else {
                showSuccessMessage("Lưu thông tin thành công");
                $("#demoGrid").DataTable().ajax.reload();
                $('#createModal').modal('hide')
            }
        });
        }
    </script>
    <!-- #endregion -->
    <!-- #region Xóa phòng thi -->
    <script>
        function DeleteData(id) {
            $("#deleteId").val(id)
            $('#modalAlertDelete').modal('show')
        }
        $('#modalAlertDelete').on('hide.bs.modal', function (event) {
            $("#deleteId").val('')
            hideMessage();
        })

        $('#btnDeleteAccess').on('click', function () {
            hideMessage();
            $.ajax({
                url: '/HoiDongThi/deleteJS',
                type: "POST",
                data: $("#formDelete").serialize(),
                success: function (result) {
                    if (result != -1)  {
                        $("#demoGrid").DataTable().ajax.reload();
                        showSuccessMessage('Xóa thông tin hội đồng thi hoàn tất.')
                    } else {
                        showAlterMessage(result.Message)
                    }
                },
                error: function (err) {
                    showAlterMessage(err.statusText);
                }
            });
            $('#modalAlertDelete').modal('hide')
        })
    </script>

    <!-- #endregion -->
    <!-- #region Sửa phòng thi -->
    <script>
    async function EditData(id) {
        await ReadonlyFalse();
        $.post("@Url.Action("getDataJS", "HoiDongThi")",
    {
        id: id
    },
    function (data) {
        if (data == -1) {
        }
        else {

            document.getElementById('txtID').value = data.id;
            document.getElementById('value_1').value = data.value_1;
            document.getElementById('value_2').value = data.value_2;
            document.getElementById('value_3').value = data.value_3;
            document.getElementById('value_4').value = data.value_4;
            document.getElementById('value_5').value = data.value_5;
            document.getElementById('value_6').value = data.value_6;
            document.getElementById('value_7').value = data.value_7;
            document.getElementById('value_8').value = data.value_8;
  


        }
    });
        }
    </script>

    <!-- #endregion -->
    <!-- #region Chi tiết phòng thi -->
    <script>
    async function Detail(id) {
        await ReadonlyFalse();
        $.post("@Url.Action("getDataJS", "HoiDongThi")",
    {
        id: id
    },
    function (data) {
        if (data == -1) {
        }
        else {
            document.getElementById('txtID').value = data.id;
            document.getElementById('value_1').value = data.value_1;
            document.getElementById('value_2').value = data.value_2;
            document.getElementById('value_3').value = data.value_3;
            document.getElementById('value_4').value = data.value_4;
            document.getElementById('value_5').value = data.value_5;
            document.getElementById('value_6').value = data.value_6;
            document.getElementById('value_7').value = data.value_7;
            document.getElementById('value_8').value = data.value_8;
        }
    });
        await ReadonlyTrue();
        }
    </script>
    <!-- #endregion -->
    <!-- #region Reset form nhập model -->
    <script>
       asycn function ResetForm()
       {
           await ReadonlyFalse();
            document.getElementById('txtID').value = "";
            document.getElementById('value_1').value = "";
            document.getElementById('value_2').value = "";
            document.getElementById('value_3').value = "";
            document.getElementById('value_4').value = "";
            document.getElementById('value_5').value = "";
            document.getElementById('value_6').value = "";
            document.getElementById('value_7').value = "";
            document.getElementById('value_8').value = "";
       }
    </script>
    <script>
        function ReadonlyFalse()
        {
            document.getElementById('txtID').readOnly = false;
            document.getElementById('value_1').readOnly = false;
            document.getElementById('value_2').readOnly = false;
            document.getElementById('value_3').readOnly = false;
            document.getElementById('value_4').readOnly = false;
            document.getElementById('value_5').readOnly = false;
            document.getElementById('value_6').readOnly = false;
            document.getElementById('value_7').readOnly = false;
            document.getElementById('value_8').readOnly = false;
        }


    </script>
    <script>
        function ReadonlyTrue()
        {
            document.getElementById('txtID').readOnly = true;
            document.getElementById('value_1').readOnly = true;
            document.getElementById('value_2').readOnly = true;
            document.getElementById('value_3').readOnly = true;
            document.getElementById('value_4').readOnly = true;
            document.getElementById('value_5').readOnly = true;
            document.getElementById('value_6').readOnly = true;
            document.getElementById('value_7').readOnly = true;
            document.getElementById('value_8').readOnly = true;
        }
    </script>
    <!-- #endregion -->
}

@section path{
<li><a href="/Home/Index"><i class="fa fa-home"></i> Trang chủ</a></li>
<li><a href="/exam/Index">Danh sách khoá thi</a></li>
    <li><a href="/HoiDongThi/Index/@id">@TenKhoaThi</a></li>
    <li class="active"></li>
}
<div class="container">
    <div class="row">
        <div class="col-sm-12">
            <div class="nav-tabs-custom" style="border-top:1px solid #f9fafc">
                <ul class="nav nav-tabs">
                    <li class="active"><a style="font-weight:bold" data-toggle="tab" href="#tab_1" aria-expanded="true" id="zoneTong1">Danh sách hội đồng thi</a></li>
                </ul>
            </div>
            <div class="box-body" style="padding:0px !important; margin-bottom:5px;text-align:right">

                <button type="button" class="btn btn-primary" onclick="ResetForm();" style="border-radius:10px;" data-toggle="modal" data-target="#createModal">
                    <i class="fa fa-plus"></i> Thêm hội đồng thi
                </button>
                <a class="btn btn-default" onclick="reload();" id="btnrefresh" title="Tải lại dữ liệu mới"><i class="fa fa-refresh"></i> Tải lại</a>

            </div>

            <div class="tab-content">
                <div id="tab_1" class="tab-pane active">
                    <div class="box">


                        <div class="box-body" style="padding:0px !important; margin-bottom:10px">
                            <div id="tbldata_wrapper" class="dataTables_wrapper form-inline dt-bootstrap no-footer">
                                <div class="row"><div class="col-sm-6"></div><div class="col-sm-6"></div></div><div class="row">
                                    <div class="col-sm-12">

                                        <table id="demoGrid" class="table table-bordered table-hover dataTable" role="grid">
                                            <thead>
                                                <tr role="row">
                                                    <th></th>
                                                    <th>Thư mục</th>
                                                    <th>Tên hội đồng thi</th>
                                                    <th>Địa điểm</th>
                                                    <th>Mô tả</th>
                                                    <th>Ghi chú</th>
                                                    <th></th>
                                                    <th></th>
                                                    <th></th>
                                                    <th></th>
                                                  
                                                    <th></th>
                                                </tr>
                                            </thead>

                                        </table><div id="tbldata_processing" class="dataTables_processing" style="display: none;">Đang tải dữ liệu...</div>
                                    </div>
                                </div><div class="row"><div class="col-sm-5"></div><div class="col-sm-7"></div></div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Model thêm mới khoản chi phí-->
<div class="modal fade in" id="createModal" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="label-model">Thêm mới phòng thi</h4><h4 class="modal-title" style="color:red" id="myModalLabel"></h4>
                <input type="hidden" value="">
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-12">
                        <!-- row -->
                        <div style="width:100%" class="hidden">
                            <div style="width:20%; float:left">
                                <label style="margin-top: 5px">ID :</label>
                            </div>
                            <div style="width:80%; float:left">
                                <input type="text" id="txtID" class="form-control" placeholder="" value="">
                            </div>
                            <div class="clear"></div>
                        </div>
                        <!-- row -->
                        <div style="width:100%">
                            <div style="width:20%; float:left">
                                <label style="margin-top: 5px">Hội đồng thi:</label>
                            </div>
                            <div style="width:80%; float:left">
                                <input type="text" id="value_1" placeholder="Nhập tên hội đồng thi" value="" class="form-control">
                            </div>
                            <div class="clear"></div>
                        </div>
                        <!-- row -->
                        <div style="width:100%">
                            <div style="width:20%; float:left">
                                <label style="margin-top: 5px">Địa điểm:</label>
                            </div>
                            <div style="width:80%; float:left">
                                <input type="text" id="value_2" placeholder="Nhập địa điểm" value="" class="form-control">
                            </div>
                            <div class="clear"></div>
                        </div>
                        <!-- row -->
                        <div style="width:100%">
                            <div style="width:20%; float:left">
                                <label style="margin-top: 5px">Mô tả:</label>
                            </div>
                            <div style="width:80%; float:left">
                                <input type="text" id="value_3" placeholder="Nhập mô tả" value="" class="form-control">
                            </div>
                            <div class="clear"></div>
                        </div>
                        <!-- row -->
                        <div style="width:100%">
                            <div style="width:20%; float:left">
                                <label style="margin-top: 5px">Ghi chú:</label>
                            </div>
                            <div style="width:80%; float:left">
                                <input type="text" id="value_4" placeholder="Nhập ghi chú" value="" class="form-control">
                            </div>
                            <div class="clear"></div>
                        </div>
                        <!-- row -->
                        <div style="width:100%" hidden>
                            <div style="width:20%; float:left">
                                <label style="margin-top: 5px">value_5:</label>
                            </div>
                            <div style="width:80%; float:left">
                                <input type="text" id="value_5" placeholder="Nhập value_5" value="" class="form-control">
                            </div>
                            <div class="clear"></div>
                        </div>
                        <!-- row -->
                        <div style="width:100%" hidden>
                            <div style="width:20%; float:left">
                                <label style="margin-top: 5px">value_6:</label>
                            </div>
                            <div style="width:80%; float:left">
                                <input type="text" id="value_6" placeholder="value_6" value="" class="form-control">
                            </div>
                            <div class="clear"></div>
                        </div>
                        <!-- row -->
                        <div style="width:100%" hidden>
                            <div style="width:20%; float:left">
                                <label style="margin-top: 5px">value_7:</label>
                            </div>
                            <div style="width:80%; float:left">
                                <input type="text" id="value_7" placeholder="value_7" value="" class="form-control">
                            </div>
                            <div class="clear"></div>
                        </div>
                        <!-- row -->
                        <div style="width:100%" hidden>
                            <div style="width:20%; float:left">
                                <label style="margin-top: 5px">value_8:</label>
                            </div>
                            <div style="width:80%; float:left">
                                <input type="text" id="value_8" placeholder="value_8" value="" class="form-control">
                            </div>
                            <div class="clear"></div>
                        </div>
                    </div>
                </div>

            </div>
            <div id="notify"></div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal"><i class="fa fa-window-close-o"></i> Đóng</button>
                <button type="button" class="btn btn-primary" onclick="SaveorCreate();" id="btnSave"><i class="fa fa-save"></i> Lưu</button>
            </div>
        </div>
    </div>
</div>
@Html.Action("MessageBox", "Common")
