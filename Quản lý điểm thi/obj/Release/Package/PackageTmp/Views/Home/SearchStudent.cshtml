@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
    string key = ViewBag.SearchKey;
    int id = 0;
}
@section Styles
{
    <link href="~/Content/select2.css" rel="stylesheet" />
}

<div class="container">
    <div class="row">
        <div class="col-sm-12">
            <div class="box-body" style="padding:0px !important; margin-bottom:5px;text-align:right">


                <a href="/Student/Createnew/@id"><button type="button" class="btn btn-primary" style="border-radius:10px;" data-toggle="modal" data-target="#createModal"><i class="fa fa-plus"></i> Thêm mới</button></a>

                <a class="btn btn-default" onclick="reload();" id="btnrefresh" title="Tải lại dữ liệu mới"><i class="fa fa-refresh"></i> Tải lại</a>

            </div>
            <div class="nav-tabs-custom" style="border-top:1px solid #f9fafc">
                <ul class="nav nav-tabs">
                    <li class="active"><a data-toggle="tab" href="#tab_1" aria-expanded="true" id="zoneTong1">Danh sách học sinh</a></li>
                </ul>
            </div>
            <div class="tab-content">
                <div id="tab_1" class="tab-pane active">
                    <div class="box">


                        <div class="box-body" style="padding:0px !important; margin-bottom:10px">
                            <div id="tbldata_wrapper" class="dataTables_wrapper form-inline dt-bootstrap no-footer">
                                <div class="row"><div class="col-sm-6"></div><div class="col-sm-6"></div></div><div class="row">
                                    <div class="col-sm-12">

                                        <table id="demoGrid" class="table table-bordered table-hover dataTable" role="grid">
                                            <thead>
                                                <tr role="row">
                                                    <th>Id</th>
                                                    <th>Khóa thi</th>
                                                    <th>Hội đồng thi</th>
                                                    <th>Năm thi</th>
                                                    <th></th>
                                                    <th></th>
                                                    <th></th>
                                                    <th></th>
                                                    <th></th>
                                                    <th></th>
                                                    <th>Sinh viên</th>

                                                    <th></th>

                                                </tr>
                                            </thead>

                                        </table><div id="tbldata_processing" class="dataTables_processing" style="display: none;">Đang tải dữ liệu...</div>
                                    </div>
                                </div><div class="row"><div class="col-sm-5"></div><div class="col-sm-7"></div></div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



@section script
{
    <script src="~/dist/js/jquery.dataTables.js"></script>
    <script src="~/dist/js/dataTables.bootstrap4.js"></script>
    <!-- #region RELOAD -->
    <script>
        function reload() {
            document.getElementById('search').value = "";
            location.reload();
        }
    </script>
    <!-- #endregion -->
    <!-- #region Tạo bảng dữ liệu -->
    <script>
        var id_Exam_Room = @id;
        $(document).ready(function () {
            let datatable = $("#demoGrid").DataTable({
                initComplete: function () {
                    $(this.api().table().container()).find('input').parent().wrap('<form>').parent().attr('autocomplete', 'off');
                },
                "processing": true, // for show progress bar
                "serverSide": true, // for process server side
                "filter": true, // this is for disable filter (search box)
                "orderMulti": false, // for disable multiple column at once
                "pageLength": 5,

                "ajax": {
                    "url": "/Home/LoadStudentData",
                    "data": { },
                    "type": "POST",
                    "datatype": "json"
                },
                "columnDefs":[
                     {
                         "targets": [0, 1, 2, 4, 5, 6, 7, 8, 9, 10],
                         "visible": false,
                     },
                     {
                         "targets": [3],
                         "searchable": false,
                         "orderable": false,

                     },
                     {
                         "targets": [11],
                         "searchable": false,
                         "orderable": false,
                         "className" : 'text-center'
                      }
                ],

                "columns": [
                      { "data": "Id", "name": "Id", "autoWidth": true },
                      { "data": "sbd", "name": "sbd", "autoWidth": true },
                      { "data": "tt", "name": "tt", "autoWidth": true },
                      {
                        "render": function (data, type, full, meta) {
                            return '<a href="/Student/detail/' + full.Id + '"><img src="/dist/img/icons8-pdf-48.png"  alt="pdf-diem-thi" style="width:30px;height:30px;margin-left:20px;cursor:pointer"></a>' +
                            '<b style="margin-left:60px;font-size:16px;cursor:context-menu" >' + full.ho_ten +  ' </b>'
                        }
                      },
                      { "data": "ho_ten", "name": "ho_ten", "autoWidth": true },
                      { "data": "ngay_sinh", "name": "ngay_sinh", "autoWidth": true },
                      { "data": "gioi_tinh", "name": "gioi_tinh", "autoWidth": true },
                      { "data": "ketqua_thi", "name": "ketqua_thi", "autoWidth": true },
                      { "data": "truong_hoc", "name": "truong_hoc", "autoWidth": true },
                      { "data": "dien_uudai", "name": "dien_uudai", "autoWidth": true },
                      { "data": "tong_so", "name": "tong_so", "autoWidth": true },

                      {
                          "render": function (data, type, full, meta)
                          {
                              return '<button type="button"  onclick = "DeleteData(' + full.Id + ')" style="padding:2px 6px;margin-left: 10px;border-radius: 10px !important;" class="btn btn-danger"><i class="fa fa-trash"></i></button>'
                          }
                      },
                ]
            });
            $("input[type='search']").wrap("<form>");
            $("input[type='search']").closest("form").attr("autocomplete", "off");
            $("input[type='search']").val("@key");
            datatable.search("@key").draw();
        });
    </script>
    <!-- #endregion -->
}